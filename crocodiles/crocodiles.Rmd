## STATS 763: Assignment 4: Don't feed the crocodiles
#### Tarin Eccleston
#### 07/10/2024

```{r results='hide', warning=FALSE, message=FALSE, error=FALSE, echo=FALSE}
library(tidyverse)
library(broom)
library(dagitty)
source("libs/lib.R")
set.seed(123)
```

The file `bitey.txt` contains information on size, jaw shape, bite force, and tooth pressure for all currently existing species of crocodilians (crocodiles, alligators, and closely related reptiles).

In these variable names, the "molariform" teeth are at the back of the jaw where food is chewed and the "caniniform" teeth at the front of the jaw where food is initially seized.  The 'rostrum' is the snout.  

### Data Manipulation

```{r warning=FALSE}
crocs <- read.table("data/bitey.txt", header=TRUE, fill=TRUE)
# remove observations with missing species
crocs <- crocs[!(crocs$Species == "" | crocs$Species == "-"), ]
# split all cols with ranges to lower and upper
crocs <- split_ranges_automatically(crocs)
# convert em-dashes to NA
crocs <- crocs %>%
  mutate(across(everything(), ~na_if(as.character(.), "â€”")))
# convert everything to numeric
crocs <- crocs %>%
  mutate(across(everything(), ~as.numeric(.)))
```

### 1) What are the relationships between the size of the crocodilian and the bite force?

We assume the size is represented by the mean total length `MTL`. We take the mean of measured covariates rather than upper or lower of ranges.

```{r warning=FALSE, message=FALSE, error=FALSE, echo=FALSE, class.output='centered-plot'}
ggplot(crocs, aes(x = as.numeric(MTL), y = as.numeric(MBF))) +
  geom_point() +
  labs(title = "Mean Total Length vs Molariform Bite Forces",
       x = "Mean Total Length (cm)",
       y = "Molariform Bite Forces (N)") +
  theme_minimal()
```

Increasing mean total length `MTL` of the crocodile appears to increase the molariform bite forces `MBF`. 

```{r warning=FALSE, message=FALSE, error=FALSE, echo=FALSE, class.output='centered-plot'}
ggplot(crocs, aes(x = as.numeric(MTL), y = as.numeric(CBF))) +
  geom_point() +
  labs(title = "Mean Total Length vs Estimated Taxon Representative Caniniform Bite Force",
       x = "Mean Total Length (cm)",
       y = "Estimated Taxon Representative Caniniform Bite Force (N)") +
  theme_minimal()
```

The estimated taxon representative caniniform bite force, `CBF`, is lower on average than the molariform bite force. The `CBF` is estimated from the molariform bite force, hence correlated.

### 2) What are the relationships between the size of the crocodilian and the tooth pressure?

```{r warning=FALSE, message=FALSE, error=FALSE, echo=FALSE, class.output='centered-plot'}
ggplot(crocs, aes(x = as.numeric(MTL), y = as.numeric(MP))) +
  geom_point() +
  labs(title = "Mean Total Length vs Taxon Representative Molariform Pressure",
       x = "Mean Total Length (cm)",
       y = "Taxon Representative Molariform Pressure (MPa)") +
  theme_minimal()
```

Similarly, increasing mean total length `MTL` of the crocodile appears to increase the Taxon Representative Molariform Pressure `MP`. 

```{r warning=FALSE, message=FALSE, error=FALSE, echo=FALSE, class.output='centered-plot'}
ggplot(crocs, aes(x = as.numeric(MTL), y = as.numeric(CP))) +
  geom_point() +
  labs(title = "Mean Total Length vs Taxon Representative Caniniform Pressure",
       x = "Mean Total Length (cm)",
       y = "Taxon Representative Caniniform Pressure (MPa)") +
  theme_minimal()
```

We can see a similar relationship for the Taxon Representative Caniniform Pressure `CP`.

### 3) Fit a model to predict bite force from the size, shape, and mass measurements

### 4) The largest and smallest crocodilians in the fossil record have total length and estimated mass (0.8m, 2.6kg: Procaimanoidea kayi, Alligatoridea) and (11m, 4600kg: Deinosuchus riograndensis, Alligatoridea). Estimate their bite force. 